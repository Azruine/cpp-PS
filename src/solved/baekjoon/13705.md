# 13705. $Ax + B\sin(x) = C$

수치 해석 문제다. 이 문제가 D5에 랭크된 큰 이유는 바로 미친 수준의 정밀도를 요구하는 것.

대략 소수점 아래 30자리정도는 정확하게 뽑아내야 한다. 이런 고정밀도 연산을 할 때에는 double로도 부족해서 long double 같은걸 쓰기 마련인데, 얘는 이것도 안 된다!

다행히 C++23에서는 std::float128_t 가 추가되었다. 이걸 써먹어보자.

당연하게도 C++ STL에서 sin 함수는 long double까지밖에 없기 때문에 사인 함수값을 계산해야 한다.

테일러 전개를 활용하면 쉬운데, 대략 100 항까지 계산하면 잘 맞는다.

여기서도 잡기술이 좀 필요한데, 사인 함수값을 계산할 때에는 $x$에서 $2n\pi$ 를 빼버려야 한다. 안 그러면 정밀도가 또 막힌다!

그리고 수치 해석을 해야하니, 이분 탐색으로 접근해야 한다. 그럼 bound는 어떻게 구할까?

일단 주어진 식을 대충 정리해보면 다음과 같다.

$\sin(x)=\frac{C - Ax}{B}$

여기서 사인값은 절대값 1을 넘지 못하므로, 이걸 가지고 생각해보면 다음과 같이 접근할 수 있다.

$\frac{C - B}{A} \leq \sin(x) \leq \frac{C + B}{A}$

따라서 $l = \frac{C - B}{A}, r = \frac{C + B}{A}$ 로 잡고 시작하면 되겠다.

여기서 짚고 넘어가야 할 포인트가 하나 있다. 이분 탐색은 기본적으로 단조 증가 혹은 단조 감소하는 구간 내에서 써먹을 수 있다.

문제에서 $0 < B \le A$ 라고 조건을 줬기 때문에 $Ax + B\sin(x)$가 항상 단조 증가임을 확인할 수 있고, 따라서 범위를 위처럼 주고 이분 탐색을 돌릴 수 있는 것이다.

이제 이분 탐색을 돌리면 되는데, 아까 말했던 것처럼 고정밀도가 필요해서 단순하게 $l < r$ 로만 조건을 걸고 돌리면 TLE를 받을 확률이 높다.

그래서 이 문제에서는 단순하게 몇 번 이분 탐색을 돌리면 소수점 이하 6자리까지는 맞출 수 있다. 나는 100 번으로 해결했다.

마지막으로, C++23에서 std::float128_t를 써먹을 때 초기값을 주려면 아래처럼 마지막에 Q를 써야한다고 한다.

```cpp
std::float128_t pi = 3.141592653589793238462643383279502884197169Q;
```
